var S=Object.defineProperty,et=t=>S(t,"__esModule",{value:!0}),rt=(t,e)=>{et(t);for(var r in e)S(t,r,{get:e[r],enumerable:!0})};rt(exports,{Cue:()=>z,_creatElement:()=>$,_createText:()=>B,_if:()=>N,_string:()=>L,_vHide:()=>q,_vShow:()=>V,_withDirectives:()=>U});function E(t,e,r){if(e==="className"&&(e="class"),/on\w+/.test(e))e=e.toLowerCase(),t[e]=r||"";else if(e==="style"){if(!r||typeof r=="string")t.style.cssText=r||"";else if(r&&typeof r=="object")for(let i in r)t.style[i]=typeof r[i]=="number"?r[i]+"px":r[i]}else e in t&&(t[e]=r||""),r?t.setAttribute(e,r):t.removeAttribute(e)}function it(t){return Object.prototype.toString.call(t).replace(/\[object\s|\]/g,"")}function g(t){return it(t)==="String"}function x(t,e){for(var r=0,i=t.length;r<i;r++)e(t[r],r)}function w(t){if(!t)return[];for(var e=[],r=0,i=t.length;r<i;r++)e.push(t[r]);return e}function I(t,e){return e.appendChild(nt(t))}function nt(t){if(typeof t=="string")return document.createTextNode(t);let e=document.createElement(t.tag);return t.attrs&&Object.keys(t.attrs).forEach(r=>{let i=t.attrs[r];if(r.indexOf("on-")!==-1){e.addEventListener(r.slice(3),i,!1);return}E(e,r,i)}),t.children&&t.children.forEach(r=>I(r,e)),e}var D=I,P=0,j=1,k=2,K=3;function m(t,e){var r={index:0};W(t,r,e)}function W(t,e,r){for(var i=r[e.index],n=t.childNodes?t.childNodes.length:0,s=0;s<n;s++){var f=t.childNodes[s];e.index++,W(f,e,r)}i&&st(t,i)}function st(t,e){x(e,function(r){switch(r.type){case P:var i=typeof r.node=="string"?document.createTextNode(r.node):r.node.render();t.parentNode.replaceChild(i,t);break;case j:ot(t,r.moves);break;case k:ft(t,r.props);break;case K:t.textContent?t.textContent=r.content:t.nodeValue=r.content;break;default:throw new Error("Unknown patch type "+r.type)}})}function ot(t,e){var r=w(t.childNodes),i={};x(r,function(n){if(n.nodeType===1){var s=n.getAttribute("key");s&&(i[s]=n)}}),x(e,function(n){var s=n.index;if(n.type===0)r[s]===t.childNodes[s]&&t.removeChild(t.childNodes[s]),r.splice(s,1);else if(n.type===1){var f=i[n.item.key]?i[n.item.key].cloneNode(!0):typeof n.item=="object"?n.item.render():document.createTextNode(n.item);r.splice(s,0,f),t.insertBefore(f,t.childNodes[s]||null)}})}function ft(t,e){for(var r in e){var i=e[r];E(t,r,i)}}m.REPLACE=P;m.REORDER=j;m.PROPS=k;m.TEXT=K;var v=m;function ct(t,e,r){for(var i=H(t,r),n=H(e,r),s=n.free,f=i.keyIndex,c=n.keyIndex,l=[],u=[],o=0,a,p,G=0;o<t.length;){if(a=t[o],p=_(a,r),p)if(!c.hasOwnProperty(p))u.push(null);else{var J=c[p];u.push(e[J])}else{var Q=s[G++];u.push(Q||null)}o++}var h=u.slice(0);for(o=0;o<h.length;)h[o]===null?(b(o),C(o)):o++;for(var d=o=0;o<e.length;){a=e[o],p=_(a,r);var T=h[d],Y=_(T,r);if(T)if(p===Y)d++;else if(!f.hasOwnProperty(p))A(o,a);else{var Z=_(h[d+1],r);Z===p?(b(o),C(d),d++):A(o,a)}else A(o,a);o++}for(var O=h.length-d;d++<h.length;)O--,b(O+o);function b(y){var R={index:y,type:0};l.push(R)}function A(y,R){var tt={index:y,item:R,type:1};l.push(tt)}function C(y){h.splice(y,1)}return{moves:l,children:u}}function H(t,e){for(var r={},i=[],n=0,s=t.length;n<s;n++){var f=t[n],c=_(f,e);c?r[c]=n:i.push(f)}return{keyIndex:r,free:i}}function _(t,e){return!t||!e?void 0:typeof e=="string"?t[e]:e(t)}var M=ct;function at(t,e){var r=0,i={};return X(t,e,r,i),i}function X(t,e,r,i){var n=[];if(!(e===null))if(g(t)&&g(e))e!==t&&n.push({type:v.TEXT,content:e});else if(t.tag===e.tag&&t.key===e.key){var s=ut(t,e);s&&n.push({type:v.PROPS,props:s}),lt(t.children,e.children,r,i,n)}else n.push({type:v.REPLACE,node:e});n.length&&(i[r]=n)}function lt(t,e,r,i,n){var s=M(t,e,"key");if(e=s.children,s.moves.length){var f={type:v.REORDER,moves:s.moves};n.push(f)}var c=null,l=r;x(t,function(u,o){var a=e[o];l=c&&c.count?l+c.count+1:l+1,X(u,a,l,i),c=u})}function ut(t,e){var r=0,i=t.attrs,n=e.attrs,s,f,c={};for(s in i){if(s.startsWith("on-"))continue;f=i[s],n[s]!==f&&(r++,c[s]=n[s])}for(s in n){if(s.startsWith("on-"))continue;f=n[s],i.hasOwnProperty(s)||(r++,c[s]=n[s])}return r===0?null:c}var F=at;function $(t,e,r){return{tag:t,attrs:e,children:r}}function B(t){return t}function L(t){return t}function N(t,e,r){return t?e():r()}function U(t,e){return e.map(([r,i])=>g(r)?void 0:r(t,i)),t}function V(t,e){t.attrs.style=`display: ${e==="true"?"block":"none"};`}function q(t,e){t.attrs.style=`display: ${e==="true"?"none":"block"};`}var z=class{constructor({script:e,css:r,tpl:i,render:n}){this.render=n,this._ctx=this.initContext(e),this.vNode=this.render(this._ctx),this._ctx.created&&this._ctx.created()}initContext(e){return e.setData=r=>{let i=this._ctx;this.data=Object.assign(i.data,r);let n=this.render(this);console.log("new node: ",n),console.log("old node: ",this.vNode);var s=F(this.vNode,n);console.log(s),v(this.root,s),this.vNode=n,this._ctx.updated&&this._ctx.updated()},e}mount(e){this.root=e,D(this.vNode,this.root),this._ctx.mounted&&this._ctx.mounted()}destroy(){this.root.innerHTML="",this._ctx.destroyed&&this._ctx.destroyed()}};
